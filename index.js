const e = require("express"), { Configuration: t, OpenAIApi: s } = require("openai"), r = require("cors"); require("dotenv").config(); const n = e(), o = new s(new t({ apiKey: process.env.OPENAI_API_KEY })); n.use(r()), n.use(e.json()), n.use("/", e.static(__dirname + "/client")), n.post("/get-prompt-result", (async (e, t) => { const { prompt: s, model: r = "gpt" } = e.body; if (!s) return t.status(400).send({ error: "Prompt is missing in the request" }); try { if ("image" === r) { const e = await o.createImage({ prompt: s, response_format: "url", size: "1024x1024" }); return t.send(e.data.data[0].url) } if ("chatgpt" === r) { const e = await o.createChatCompletion({ model: "gpt-3.5-turbo", messages: [{ role: "user", content: s }] }); return t.send(e.data.choices[0]?.message?.content) } return t.send(completion.data.choices[0].text) } catch (e) { const s = e.response ? e.response.data.error : `${e}`; return console.error(s), t.status(500).send(s) } })); const a = process.env.PORT || 3001; n.listen(a, (() => console.log(`Listening on port ${a}`)));