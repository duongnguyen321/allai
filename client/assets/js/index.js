const e=new showdown.Converter;let t=null,n=null;const o=document.getElementById("submit-button"),l=document.getElementById("regenerate-response-button"),s=document.getElementById("prompt-input"),a=document.getElementById("model-select"),i=document.getElementById("response-list");let r=!1,c=null;function d(e,t){const n=`id-${Date.now()}-${Math.random().toString(16)}`,o=`\n            <div class="response-container ${e?"my-question":"chatgpt-response"}">\n                <img class="avatar-image" src="assets/img/${e?"me":"chatgpt"}.png" alt="avatar"/>\n                <div class="prompt-content" id="${n}">${t}</div>\n            </div>\n        `;return i.insertAdjacentHTML("beforeend",o),i.scrollTop=i.scrollHeight,n}function m(e,t){e.innerHTML=t,e.style.color="rgb(200, 0, 0)"}function g(e,o){t=e,n=o,l.style.display="flex"}async function u(u,p){const v=u??s.textContent;if(r||!v)return;o.classList.add("loading"),s.textContent="",p||d(!0,`<div>${v}</div>`);const y=p??d(!1),f=document.getElementById(y);var h;(h=f).textContent="",c=setInterval((()=>{h.textContent+=".","...."===h.textContent&&(h.textContent="")}),300),r=!0;try{const o=a.value,s=await fetch("/get-prompt-result",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:v,model:o})});if(!s.ok)return g(v,y),void m(f,`HTTP Error: ${await s.text()}`);const r=await s.text();f.innerHTML="image"===o?`<img src="${r}" class="ai-image" alt="generated image"/>`:e.makeHtml(r.trim()),t=null,n=null,l.style.display="none",setTimeout((()=>{i.scrollTop=i.scrollHeight,hljs.highlightAll()}),10)}catch(e){g(v,y),m(f,`Error: ${e.message}`)}finally{r=!1,o.classList.remove("loading"),clearInterval(c)}}s.addEventListener("keydown",(function(e){"Enter"===e.key&&(e.preventDefault(),e.ctrlKey||e.shiftKey?document.execCommand("insertHTML",!1,"<br/><br/>"):u())})),o.addEventListener("click",(()=>{u()})),l.addEventListener("click",(()=>{!async function(){try{await u(t,n),l.classList.add("loading")}finally{l.classList.remove("loading")}}()})),window.onload=function(){(!localStorage.isVisited||localStorage.visitedTime>=5)&&(confirm("Please Give me a shining star ‚ú¥Ô∏è")||alert("Please give me a star to use ü§ó"),open("https://github.com/duongnguyen321/allai","_blank"),localStorage.isVisited=!0,localStorage.visitedTime=0),console.groupCollapsed("%cHello From Client side!","color: #20e3b2"),console.log("%cI am Duong from %chttps://duong.vercel.app%c!","color: #20e3b2","color: #58a6ff","color: #10a37f"),console.groupEnd(),console.groupCollapsed("%cPlease be a responsible user!","color: #f55"),console.log("%cThank you!","color: #20e3b2"),console.groupEnd(),s.focus(),localStorage.visitedTime=JSON.parse(localStorage.visitedTime)+1};